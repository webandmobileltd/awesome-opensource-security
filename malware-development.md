# opensource-malware-development

A collection of open source malware development tools

## Collections

3rd-party lists

* [ExpLife0011/awesome-windows-kernel-security-development](https://github.com/ExpLife0011/awesome-windows-kernel-security-development)
* [howknows/awesome-windows-security-development](https://github.com/howknows/awesome-windows-security-development)
* [r00t-3xp10it/hacking-material-books - collection of articles/books about programing](https://github.com/r00t-3xp10it/hacking-material-books)
* [Know your Resources, be your Knowledge | MalwareAnalysis.co](https://malwareanalysis.co/)

Vulnerability scanner

* [badssl - SSL 证书错误](https://badssl.com/)
* [wivet - 爬虫链接覆盖度测试](https://github.com/bedirhan/wivet)
* [安赛科技，包含一些其他厂商的](http://demo.aisec.cn/demo/)

MacOS libraries

* [objective-see/FileMonitor - File Monitor Library (based on Apple's new Endpoint Security Framework)](https://github.com/objective-see/FileMonitor)
* [its-a-feature/bifrost - Objective-C library and console to interact with Heimdal APIs for macOS Kerberos](https://github.com/its-a-feature/bifrost)
* [gist: An example of using the libEndpointSecurity.dylib in Catalina - Mac下面的各种监控回调，需要特殊的entitlements，没测试](https://gist.github.com/knightsc/4678757164b2c63a58856a1acb3dd17e)
* [gist: Ask for privilege to execute command](https://gist.github.com/TomLiu/5811875)
  * [objective-see: Sniffing Authentication References on macOS - details of a privilege-escalation vulnerability (CVE-2017-7170)](https://objective-see.com/blog/blog_0x55.html)

Windows libraries

* [jas502n/mimikat_ssp - 用RPC调用替代AddSecurityPackage函数，实现DLL加载](https://github.com/jas502n/mimikat_ssp)
* [Pavel's Blog: How can I close a handle in another process - 使用 NtQueryInformationProcess 获取所有 Handle，使用 DUPLICATE_CLOSE_SOURCE 参数复制 Handle，然后就实现了源的关闭](https://scorpiosoftware.net/2020/03/15/how-can-i-close-a-handle-in-another-process/)
* [itm4n/FullPowers - Recover the default privilege set of a LOCAL/NETWORK SERVICE account - 通过创建计划任务，恢复 local service 原有的特权](https://github.com/itm4n/FullPowers)
* [xtahi0nix/SetCriticalProcesses - Creating critical processes in Windows](https://github.com/xtahi0nix/SetCriticalProcesses)
* [jthuraisamy/SysWhispers - AV/EDR evasion via direct system calls](https://github.com/jthuraisamy/SysWhispers)
* [DarthTon/Blackbone - Windows memory hacking library - 文档少，直接看例子](https://github.com/DarthTon/Blackbone)
* [hakril/PythonForWindows - A codebase aimed to make interaction with Windows and native execution easier - Python 库，获取一些底层信息](https://github.com/hakril/PythonForWindows)
* [arbiter34/GetProcAddress - Recreation of GetProcAddress without external dependencies on Windows Libraries](https://github.com/arbiter34/GetProcAddress)
* [woanware/win-catalog-dotnet - Managed library for accessing the Windows security catalog files](https://github.com/woanware/win-catalog-dotnet)
* [Mr-Un1k0d3r/RedTeamCSharpScripts - C# Script used for Red Team](https://github.com/Mr-Un1k0d3r/RedTeamCSharpScripts)
* [FuzzySecurity/Sharp-Suite - My musings with C#](https://github.com/FuzzySecurity/Sharp-Suite)
* [microsoft/WindowsProtocolTestSuites - Windows Protocol Test Suites provide interoperability testing against an implementation of the Windows open specifications - 各种底层协议测试代码，应该会有用处](https://github.com/microsoft/WindowsProtocolTestSuites)
* [DoubleLabyrinth/SecurityDescriptorHelper - SecurityDescriptor Helper - 可以解读 D:P(A;;GA;;;SY) 这样的字符串](https://github.com/DoubleLabyrinth/SecurityDescriptorHelper)
* [DavidXanatos/wumgr - Windows update managemetn tool for windows 10](https://github.com/DavidXanatos/wumgr)
* [gist: w4kfu/95a87764db7029e03f09d78f7273c4f4 - SHIM 构建和注入，即使 compat 工具不支持；2016开始失效](https://gist.github.com/w4kfu/95a87764db7029e03f09d78f7273c4f4)
* [apriorit/SvcHostDemo - Demo service that runs in svchost.exe](https://github.com/apriorit/SvcHostDemo)
* [SinaKarvandi/Process-Magics - This is a collection of interesting codes about Windows Process creation - CriticalProcess/EnumHandles/ImpersonationPipeLine/...](https://github.com/SinaKarvandi/Process-Magics)
* [itm4n/CDPSvcDllHijacking - 代码的核心价值不是DLL劫持，而是token kidnapping: 遍历4~0xffff编号，尝试复制token，若成功则检查token是否可以利用](https://github.com/itm4n/CDPSvcDllHijacking)
* [blog: Quickpost: SelectMyParent or Playing With the Windows Process Tree - 指定父进程启动，可以降权也可以提权](https://blog.didierstevens.com/2009/11/22/quickpost-selectmyparent-or-playing-with-the-windows-process-tree/)
  * [decoder-it/psgetsystem - getsystem via parent process using ps1 & embeded c#](https://github.com/decoder-it/psgetsystem)
* [b4rtik/ATPMiniDump - Evading WinDefender ATP credential-theft - 替换 MiniDumpWriteDump 为 PssCaptureSnapshot 即可](https://github.com/b4rtik/ATPMiniDump)
* [panagioto/SyscallHide - Create a Run registry key with direct system calls. Inspired by @Cneelis's Dumpert and SharpHide - 过不了sysmon](https://github.com/panagioto/SyscallHide)
* [outflanknl/Ps-Tools - an advanced process monitoring toolkit for offensive operations](https://github.com/outflanknl/Ps-Tools)
* Filesystem
  * [Real-time file monitoring on Windows with osquery - Windows 文件监控三种方案: ReadDirectoryChangesW 缓冲区大小固定，事件丢失多；内核驱动容易崩溃；NTFS journal 最可靠，osquery 就是这样做的](https://blog.trailofbits.com/2020/03/16/real-time-file-monitoring-on-windows-with-osquery/)
* Graphics
  * [vmcall/dxgkrnl_hook - C++ graphics kernel subsystem hook](https://github.com/vmcall/dxgkrnl_hook)
* Anti debug
  * [lurumdare/khaleesi - Anti-debug library](https://github.com/lurumdare/khaleesi)
* Memory loading
  * [fancycode/MemoryModule - 内存DLL加载，非常稳定 - MemoryLoadLibrary()/MemoryLoadLibraryEx()](https://github.com/fancycode/MemoryModule)
  * [86hh/DreamLoader - Simple 32/64-bit PEs loader](https://github.com/86hh/DreamLoader)
  * [zeroSteiner/reflective-polymorphism - provides various utilities for the self-modification of PE images](https://github.com/zeroSteiner/reflective-polymorphism)
  * [wheelerlaw/go-memory-module - Go wrapper for in-memory DLL module loader, MemoryModule](https://github.com/wheelerlaw/go-memory-module)
  * [rasta-mouse/TikiTorch - Process Hollowing via DotNetToJScript](https://github.com/rasta-mouse/TikiTorch)
  * [kernelm0de/RunPE-ProcessHollowing - Process Hollowing is a technique mainly used by Malware Creators to hide malicious code behind Legitimate Process](https://github.com/kernelm0de/RunPE-ProcessHollowing)
  * [m0n0ph1/Process-Hollowing - Great explanation of Process Hollowing](https://github.com/m0n0ph1/Process-Hollowing)
  * [aaaddress1/RunPE-In-Memory - Run a 32bit copy of Exe File in memory (like what Software Packer Do)](https://github.com/aaaddress1/RunPE-In-Memory)
  * [Zer0Mem0ry/RunPE - Code that allows running another windows PE in the same address space as the host process](https://github.com/Zer0Mem0ry/RunPE)
  * [nettitude/SimplePELoader - A very simple PE loader for loading DLL's into memory without using LoadLibrary](https://github.com/nettitude/SimplePELoader)
* UWP
  * [zodiacon/RunAppContainer - Run executables in an AppContainer - 通过白名单权限方式，在UWP下面执行命令](https://github.com/zodiacon/RunAppContainer)
* Printer
  * [uri247/wdk81 - Print Monitors Samples](https://github.com/uri247/wdk81/tree/master/Print%20Monitors%20Samples/C%2B%2B/localmon)
* 签名工具
  * [paranoidninja/CarbonCopy - A tool which creates a spoofed certificate of any online website and signs an Executable for AV Evasion - 用Web证书给PE签名是否合理？](https://github.com/paranoidninja/CarbonCopy)
  * [mattifestation/PoCSubjectInterfacePackage - A proof-of-concept subject interface package (SIP) used to demonstrate digital signature subversion attacks - WINTRUST PE 签名校验的样例](https://github.com/mattifestation/PoCSubjectInterfacePackage)
    * [SpectorOps: Subverting Trust in Windows](https://www.specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf)
* Cheat
  * [niemand-sec/AntiCheat-Testing-Framework - Framework to test any Anti-Cheat](https://github.com/niemand-sec/AntiCheat-Testing-Framework)

.NET Libraries

* [two06/Inception - Provides In-memory compilation and reflective loading of C# apps for AV evasion](https://github.com/two06/Inception)
* [rasta-mouse/MiscTools - 主要是远程执行，包含 Service/三种DCOM/WMI/WINRM 实现](https://github.com/rasta-mouse/MiscTools)
* [pardeike/Harmony - A library for patching, replacing and decorating .NET and Mono methods during runtime](https://github.com/pardeike/Harmony)
* [TheWover/donut - Generates x86, x64, or AMD64+x86 position-independent shellcode that loads .NET Assemblies from memory and runs them with parameters - 测试有效](https://github.com/TheWover/donut)
* [googleprojectzero/sandbox-attacksurface-analysis-tools/NtApiDotNet - Managed .NET library for accessing NT API - 各种 Undocumented NT API 调用例子，比如 NtCreateToken](https://github.com/googleprojectzero/sandbox-attacksurface-analysis-tools/tree/master/NtApiDotNet)
* [modexp: How Red Teams Bypass AMSI and WLDP for .NET Dynamic Code - 禁用AMSI和Lockdown Policy的代码，以及扫描测试](https://modexp.wordpress.com/2019/06/03/disable-amsi-wldp-dotnet/)
* [0xbadjuju/TellMeYourSecrets - A C# DLL to Dump LSA Secrets](https://github.com/0xbadjuju/TellMeYourSecrets)
* [caseysmithrc/AssemblyLoader - Loads .NET Assembly Via CLR Loader - C++ 内存加载 .NET 代码](https://github.com/caseysmithrc/AssemblyLoader)
* [ZenLulz/MemorySharp - A C# based memory editing library targeting Windows applications, offering various functions to extract and inject data and codes into remote processes to allow interoperability](https://github.com/ZenLulz/MemorySharp)
* [cobbr/SharpGen - a .NET Core console application that utilizes the Rosyln C# compiler to quickly cross-compile .NET Framework console applications or libraries](https://github.com/cobbr/SharpGen)
* [matterpreter/OffensiveCSharp - Collection of Offensive C# Tooling](https://github.com/matterpreter/OffensiveCSharp)
* [0xbadjuju/rundotnetdll32 - Execute a .Net DLL method from the command line](https://github.com/0xbadjuju/rundotnetdll32)
* [bytecode77/self-morphing-csharp-binary - C# binary that mutates its own code, encrypts and obfuscates itself on runtime](https://github.com/bytecode77/self-morphing-csharp-binary)
* [elitest/dotnetover.net - load .Net assemblies over the Internet using Powershell using a concept called ".Net over .net" - 其实就是给 AppDomain.CurrentDomain.AssemblyResolve 加个回调而已](https://github.com/elitest/dotnetover.net)
* [tyranid/WindowsRpcClients - a collection of C# class libraries which implement RPC clients for various versions of the Windows Operating System from 7 to Windows 10](https://github.com/tyranid/WindowsRpcClients)
* [SteveSyfuhs/Kerberos.NET - A Kerberos implementation built entirely in managed code](https://github.com/SteveSyfuhs/Kerberos.NET)
* [CaledoniaProject/CsharpSQLite - 纯C#实现SQLite数据库，10年前的代码了，能读取chrome密码，修了一些bug](https://github.com/CaledoniaProject/CsharpSQLite)
* [dahall/Vanara - A set of .NET libraries for Windows implementing PInvoke calls to many native Windows APIs with supporting wrappers](https://github.com/dahall/Vanara)
* [anthemtotheego/SharpNado - a proof of concept tool written in C# that demonstrates how you could use Windows Communication Foundation (WCF) or .NET Remoting to host smarter and dynamic .NET payloads - 就是简单的asm加载而已](https://github.com/anthemtotheego/SharpNado)
* [slyd0g/C-Sharp-Out-Minidump - C# implementation of Out-Minidump.ps1](https://github.com/slyd0g/C-Sharp-Out-Minidump)
* [cobbr/SharpSploit - a .NET post-exploitation library written in C# that aims to highlight the attack surface of .NET and make the use of offensive .NET easier for red teamers](https://github.com/cobbr/SharpSploit)
* [lukebakken/windows-processes - C# code for starting processes](https://github.com/lukebakken/windows-processes)
* [leoloobeek/csharp - Various C# projects for offensive security - 有 STARTUPINFOEX 的例子](https://github.com/leoloobeek/csharp)
* [0xthirteen/SharpRDP - Remote Desktop Protocol Console Application for Authenticated Command Execution - 模拟3389登陆，Win + R 执行，会有 RunMRU 日志](https://github.com/0xthirteen/SharpRDP)
* [kzu/InjectModuleInitializer - Console program and nuget package to inject a module initializer method into a built .NET assembly](https://github.com/kzu/InjectModuleInitializer)
* Evasion
  * [rasta-mouse/AmsiScanBufferBypass - Circumvent AMSI by patching AmsiScanBuffer - 内存补丁实现](https://github.com/rasta-mouse/AmsiScanBufferBypass)
  * [MinatoTW/CLMBypassBlogpost - C# 调用 powershell 示例，包含上面的AMSI补丁功能](https://github.com/MinatoTW/CLMBypassBlogpost)
* Lateral movements
  * [anthemtotheego/SharpExec - PSExec/WMIExec 实现](https://github.com/anthemtotheego/SharpExec)
* Privilege escalation
  * [murrayju/CreateProcessAsUser - Creates a process in a different Windows session - 包含 WTSEnumerateSessions/CreateProcessAsUser pinvoke 实现样例](https://github.com/murrayju/CreateProcessAsUser)
  * [malcomvetter/CSExec - An implementation of PSExec in C#](https://github.com/malcomvetter/CSExec)
* File system
  * [uknowsec/SharpCheckInfo - 收集目标主机信息，包括最近打开文件，系统环境变量和回收站文件等等 - 他有些地方实现不完善，不过思路还是对的](https://github.com/uknowsec/SharpCheckInfo)
  * [goldfix/Transactional-NTFS-TxF-.NET - a small library .Net (C#) allows to use transactions on NTFS FileSystem (Transactional NTFS (TxF))](https://github.com/goldfix/Transactional-NTFS-TxF-.NET)
* DLL Export
  * [3F/DllExport - .NET DllExport](https://github.com/3F/DllExport)
* Link tool
  * [dgiagio/warp - Create self-contained single binary applications](https://github.com/dgiagio/warp)
  * [dotnet/ILMerge - a static linker for .NET Assemblies - 作者说无法处理WPF程序](https://github.com/dotnet/ILMerge)
  * [Fody/Costura - Embeds dependencies as resources - 会增加一些PDB特征，不建议使用](https://github.com/Fody/Costura)

Windows kernel

* [alxbrn/kernel-injector - Kernel Injector pasted from various different Github repositories](https://github.com/alxbrn/kernel-injector)
* [wbenny/injdrv - Windows Driver for injecting DLL into user-mode processes using APC - 未测试，说是全版本Windows支持](https://github.com/wbenny/injdrv)
  * [Bypassing the Microsoft-Windows-Threat-Intelligence Kernel APC Injection Sensor - ATP 已经有监控了，这里介绍了一些绕过思路，以及微软官方是怎么发现的，没仔细看](https://medium.com/@philiptsukerman/bypassing-the-microsoft-windows-threat-intelligence-kernel-apc-injection-sensor-92266433e0b0)
* [SinaKarvandi/Misc - ObRegisterCallbacks 监控进程创建，TypeInfoCallbacksHooker 查找钩子](https://github.com/SinaKarvandi/Misc)
* [ciyze/Windows-Rootkits](https://github.com/ciyze/Windows-Rootkits)
* [yardenshafir/SymlinkCallback - tree/part-two - uses the option to set a dynamic target for a symbolic link and hooks the symlink of the C: volume](https://github.com/yardenshafir/SymlinkCallback/tree/part-two)
* [DavidXanatos/IgnoreACLs - A driver to make windows ignore Access Control when accessing files](https://github.com/DavidXanatos/IgnoreACLs)
* [HyperSine/Windows10-CustomKernelSigners - Load self-signed drivers without TestSigning or disable DSE - 仅供测试，感觉没啥用](https://github.com/HyperSine/Windows10-CustomKernelSigners)
* [Professor-plum/Reflective-Driver-Loader - a injection technique base off Reflective DLL injection by Stephen Fewer.](https://github.com/Professor-plum/Reflective-Driver-Loader)
* [nsacyber/Driver-Collider - Blocks drivers from loading by using a name collision technique](https://github.com/nsacyber/Driver-Collider)
* [SouhailHammou/Drivers - Windows drivers I wrote](https://github.com/SouhailHammou/Drivers)
* [yangruiqiyr/Syscall-Monitor - 一个用Intel VT-X/EPT实现的类似Sysinternal's Process Monitor的工具。现已迁移至QT框架，支持32位/64位Windows 7及以上系统](https://github.com/yangruiqiyr/Syscall-Monitor)
* [isoadam/gina_public - Prototype of hijacking Windows driver dispatch routines in unmapped discardable sections](https://github.com/isoadam/gina_public)
* [OSRDrivers/kmexts - Simple driver to register all available process, thread, image, Registry, and Object callbacks](https://github.com/OSRDrivers/kmexts)
* [d35ha/xKeLogger - Kernel mode windows NT API logger](https://github.com/d35ha/xKeLogger)
* [0xcpu/ExecutiveCallbackObjects - Research on Windows Kernel Executive Callback Objects](https://github.com/0xcpu/ExecutiveCallbackObjects)
* [Mattiwatti/PPLKiller - Protected Processes Light Killer](https://github.com/Mattiwatti/PPLKiller)
* [Gbps/gbhv - Simple x86-64 VT-x Hypervisor with EPT Hooking](https://github.com/Gbps/gbhv)
* [supermanc88/KeyboardEncrypt - 键盘加密传输](https://github.com/supermanc88/KeyboardEncrypt)
* [zhuhuibeishadiao/JunkDriveOpenSource - Some garbage drivers written for getting started](https://github.com/zhuhuibeishadiao/JunkDriveOpenSource)
* [0vercl0k/kdmp-parser - Windows kernel dump C++ parser](https://github.com/0vercl0k/kdmp-parser)
* Cheating
  * [alxbrn/rccom-leak - Rainbow Six Siege & Apex Legends source leak from risecheats.com - 写个驱动修改内存，然后就绕过反作弊了](https://github.com/alxbrn/rccom-leak)
* Bootloader
  * [maharmstone/quibble - an open-source reimplementation of the files bootmgfw.efi and winload.efi, able to boot every version of Windows from XP to Windows 10 1909](https://github.com/maharmstone/quibble)
* Patchguard
  * [zhuhuibeishadiao/PatchGuardResearch - win10 PatchGuard 动态解密(btc版本)](https://github.com/zhuhuibeishadiao/PatchGuardResearch)
  * [9176324/Shark - Turn off PatchGuard in real time for win7 (7600) ~ win10 (18950)](https://github.com/9176324/Shark)
* DSE Bypass  
  * [SamLarenN/CPUZ-DSEFix - Exploiting CPU-Z Driver To Turn Load Unsigned Drivers](https://github.com/SamLarenN/CPUZ-DSEFix)
  * [hfiref0x/TDL - Driver loader for bypassing Windows x64 Driver Signature Enforcement](https://github.com/hfiref0x/TDL)
  * [hfiref0x/UPGDSED - Universal PatchGuard and Driver Signature Enforcement Disable](https://github.com/hfiref0x/UPGDSED)
  * [hfiref0x/DSEFix - Windows x64 Driver Signature Enforcement Overrider - 测试到2019全补丁版本都有效。完善的方案需要同时Patch BSOD handler，并禁用 Program Compatibility Assistant (PcaSvc) 服务，这个程序没有做](https://github.com/hfiref0x/DSEFix)
* Signed driver abuse
  * [WinDivert - 有签名的内核驱动，支持抓包/改包/丢弃包，可以用来屏蔽AV联网](https://www.reqrypt.org/windivert.html)
  * [ProcessHacker - 支持 ZwTerminateProcess、读取任意进程内存，签名是2016年的](https://github.com/processhacker/processhacker/blob/master/KProcessHacker/devctrl.c)
  * [huoji120/GpuzMaper - using gpuz to load driver](https://github.com/huoji120/GpuzMaper)
  * [realoriginal/ppdump-public - Protected Process (Light) Dump: Uses Zemana AntiMalware Engine To Open a Privileged Handle to a PP/PPL Process And Inject MiniDumpWriteDump() Shellcode](https://github.com/realoriginal/ppdump-public)
* Capcom
  * [tandasat/ExploitCapcom - a standalone exploit for a vulnerable feature in Capcom.sys](https://github.com/tandasat/ExploitCapcom)
  * [notscimmy/libcapcom - Capcom driver exploit wrapper](https://github.com/notscimmy/libcapcom)
  * [FuzzySecurity/Capcom-Rootkit - Capcom Rootkit Proof-Of-Concept](https://github.com/FuzzySecurity/Capcom-Rootkit)
  * [ihack4falafel/OSEE - Kernel Exploitation/Capcom](https://github.com/ihack4falafel/OSEE/tree/master/Kernel%20Exploitation/Capcom)
* Exploits
  * [hoangprod/DanSpecial - Weaponizing Gigabyte driver for priv escalation and bypass PPL - 源代码里嵌入了驱动](https://github.com/hoangprod/DanSpecial)
  * [shjalayeri/DriveCrypt - DriveCrypt Dcr.sys vulnerability exploit](https://github.com/shjalayeri/DriveCrypt)
  * [DoubleLabyrinth/SdoKeyCrypt-sys-local-privilege-elevation - SdoKeyCrypt.sys - Local Privilege Elevation Vulnerability - 只是POC，带驱动文件](https://github.com/DoubleLabyrinth/SdoKeyCrypt-sys-local-privilege-elevation)
  * [Barakat/CVE-2019-16098 - Local privilege escalation PoC exploit for CVE-2019-16098](https://github.com/Barakat/CVE-2019-16098)

Source code protection

* [HikariObfuscator/Hikari - LLVM Obfuscator 停止维护，但支持 LLVM 6.X](https://github.com/HikariObfuscator/Hikari)
* [mull-project/libirm - Low-level IR mutations for LLVM Bitcode](https://github.com/mull-project/libirm)
* [thebabush/dumb-obfuscator - Tutorial on how to write the dumbest obfuscator I could think of](https://github.com/thebabush/dumb-obfuscator)
* C
  * [Hidden in PEB Sight: Hiding Windows API Imports With a Custom Loader](https://gist.github.com/christophetd/37141ba273b447ff885c323c0a7aff93)
* Swift
  * [rockbruno/swiftshield - Swift Obfuscator that protects iOS apps against reverse engineering attacks](https://github.com/rockbruno/swiftshield)
* PHP
  * [naneau/php-obfuscator - A parsing PHP obfuscator - 2016后停止更新，连字符串混淆都不做](https://github.com/naneau/php-obfuscator)
* Go
  * [unixpickle/gobfuscate - Obfuscate Go binaries and packages](https://github.com/unixpickle/gobfuscate)
* Python
  * [Hnfull/Intensio-Obfuscator - Obfuscate a python code 2.x and 3.x](https://github.com/Hnfull/Intensio-Obfuscator)
  * [liftoff/pyminifier - a Python code minifier, obfuscator, and compressor](https://github.com/liftoff/pyminifier)
  * [astrand/pyobfuscate - a source code obfuscator](https://github.com/astrand/pyobfuscate)
  * [dashingsoft/pyarmor - A tool used to obfuscate python scripts, bind obfuscated scripts to fixed machine or expire obfuscated scripts](https://github.com/dashingsoft/pyarmor)
  * [QQuick/Opy - Obfuscator for Python](https://github.com/QQuick/Opy)
* Powershell
  * [danielbohannon/Invoke-CradleCrafter - PowerShell Remote Download Cradle Generator & Obfuscator](https://github.com/danielbohannon/Invoke-CradleCrafter)
  * [danielbohannon/Invoke-Obfuscation - PowerShell Obfuscator](https://github.com/danielbohannon/Invoke-Obfuscation)
  * [ChrisAD/ads-payload - take any payload and put it in the a bat script which delivers the payload. The payload is delivered using environment variables, alternating data streams and wmic.](https://github.com/ChrisAD/ads-payload)  
* VBS
  * [kkar/VBS-Obfuscator-in-Python - VBScript obfuscation to allow PenTesters bypass countermeasures](https://github.com/kkar/VBS-Obfuscator-in-Python)
* CMD
  * [danielbohannon/Invoke-DOSfuscation - Cmd.exe Command Obfuscation Generator & Detection Test Harness](https://github.com/danielbohannon/Invoke-DOSfuscation)
* C++
  * [andrivet/ADVobfuscator - use C++11/14 language to generate, at compile time, obfuscated code without using any external tool and without modifying the compiler](https://github.com/andrivet/ADVobfuscator)

Binary protection

* [d35ha/CallObfuscator - Obfuscate specific windows apis with different apis](https://github.com/d35ha/CallObfuscator)
* [nullsecuritynet/tools - binary/hyperion - a runtime encrypter for 32/64 bit portable executables](https://github.com/nullsecuritynet/tools/tree/master/binary/hyperion)
* [enkomio/sacara - A stack based intermediate language aimed at software protection by running in a software VM - VM壳](https://github.com/enkomio/sacara)
* [UPX - the Ultimate Packer for eXecutables](https://github.com/upx/upx)
* [elfmaster/dsym_obfuscate - Obfuscates dynamic symbol table](https://github.com/elfmaster/dsym_obfuscate)
* [NYAN-x-CAT/Lime-Crypter - Obfuscation Tool](https://github.com/NYAN-x-CAT/Lime-Crypter)
* [terjanq/JS-Alpha - Funny project to create an encoder/obfuscator that converts any javascript code into a code that only consist of /[a-z().]/ characters](https://github.com/terjanq/JS-Alpha)
* [GoSSIP-SJTU/Armariris - 孤挺花（Armariris） -- 由上海交通大学密码与计算机安全实验室维护的LLVM混淆框架](https://github.com/GoSSIP-SJTU/Armariris)
* [Luis-Hebendanz/0pack - A novel technique to hide code from debuggers](https://github.com/Luis-Hebendanz/0pack)
* [yazhiwang/ollvm-tll - Ollvm+Armariris+LLVM 6.0.0](https://github.com/yazhiwang/ollvm-tll)
* [a0rtega/metame - a metamorphic code engine for arbitrary executables](https://github.com/a0rtega/metame)
* .NET
  * [mkaring/ConfuserEx - An open-source, free protector for .NET applications - 老版非常垃圾，对类属性处理有问题，不兼容 JSON.NET；新版本没测试过](https://github.com/mkaring/ConfuserEx)
* Mac
  * [kam800/MachObfuscator - a programming-language-agnostic Mach-O apps obfuscator for Apple platforms](https://github.com/kam800/MachObfuscator)

Linux libraries

* [kubo/plthook - Hook function calls by replacing PLT(Procedure Linkage Table) entries](https://github.com/kubo/plthook)
* [finixbit/elf-parser - ELF 解析库](https://github.com/finixbit/elf-parser)
* Dropper
  * [bytecode77/pe-union - PEunion (Binder, Crypter & Downloader)](https://github.com/bytecode77/pe-union)
  * [droberson/ELFcrypt - Simple ELF crypter. Uses RC4 encryption - 这个要写临时文件，根本不是真的壳](https://github.com/droberson/ELFcrypt)
* Memory loading
  * [m1m1x/memdlopen - dlopen from memory](https://github.com/m1m1x/memdlopen)
* Kernel module
  * [perceptionpoint/suprotect - Changing memory protection in an arbitrary process](https://github.com/perceptionpoint/suprotect)  
  * [cppcoffee/inl_hook - a linux kernel function inline hooking library](https://github.com/cppcoffee/inl_hook)
  * [avielw/kplugs - a Linux kernel module which provides an interface for dynamically executing scripts inside the Linux kernel](https://github.com/avielw/kplugs)

Mac libraries

* [rodionovd/rd_route - Function hooking for macOS](https://github.com/rodionovd/rd_route)
* [objective-see/ProcessMonitor - Process Monitor Library (based on Apple's new Endpoint Security Framework)](https://github.com/objective-see/ProcessMonitor)
* [CylanceVulnResearch/osx_runbin - Running Executables on macOS from Memory](https://github.com/CylanceVulnResearch/osx_runbin)

Java libraries

* [JReFrameworker/JReFrameworker - A practical tool for bytecode manipulation and creating Managed Code Rootkits (MCRs) in the Java Runtime Environment](https://github.com/JReFrameworker/JReFrameworker)

Go libraries

* [VividCortex/godaemon - Daemonize Go applications deviously](https://github.com/VividCortex/godaemon)
* [gen0cide/gscript - framework to rapidly implement custom droppers for all three major operating systems](https://github.com/gen0cide/gscript)
* [matiasinsaurralde/go-dotnet - Go wrapper for the .NET Core Runtime](https://github.com/matiasinsaurralde/go-dotnet)
* [cloudfoundry/gosigar/psnotify - proc events golang 实现，这个库有个 PID 过滤需要手动删除](https://github.com/cloudfoundry/gosigar/tree/master/psnotify)
* [0xrawsec/golang-evtx - a parsing library for Windows EVTX log files - release里有转JSON的工具](https://github.com/0xrawsec/golang-evtx)
* [ropnop/go-clr - A PoC package for hosting the CLR and executing .NET from Go](https://github.com/ropnop/go-clr)

Python libraries

* [operatorequals/httpimport - Module for remote in-memory Python package/module loading through HTTP/S](https://github.com/operatorequals/httpimport)

Browser

* [medium: Javascript Anti Debugging — Some Next Level Shit (Part 1 — Abusing SourceMappingURL) - 使用SourceMappingURL加载JS，devtools不会有日志，估计很快会被修复](https://medium.com/@weizmangal/javascript-anti-debugging-some-next-level-sh-t-part-1-abusing-sourcemappingurl-da91ff948e66)
* [niklasvh/html2canvas - Screenshots with JavaScript](https://github.com/niklasvh/html2canvas)
* [CaledoniaProject/chrome-extension-examples - chrome 扩展例子](https://github.com/CaledoniaProject/chrome-extension-examples)
* [orbitbot/chrome-extensions-examples - All Chrome Extension examples collected into one repository](https://github.com/orbitbot/chrome-extensions-examples)

IOT

* [landley/aboriginal - IOT 跨平台开发环境，最后更新2017年](https://github.com/landley/aboriginal)

Process injection / DLL injection

* [sevagas/weaponize_process_injection_windows_SIGSEGv2_2019 - 介绍了一些隐蔽的代码注入方式，没有给代码，未测试](https://github.com/sevagas/weaponize_process_injection_windows_SIGSEGv2_2019)
* [0xcpu/exthost - A POC for Windows Extension Host hooking](https://github.com/0xcpu/exthost)
* [vector-sec/a049bf12da619d9af8f9c7dbd28d3b56 - PowerShell script to enumerate all Process and Thread tokens](https://gist.github.com/vector-sec/a049bf12da619d9af8f9c7dbd28d3b56)
* [hlldz/APC-PPID - Adds a user-mode asynchronous procedure call (APC) object to the APC queue of the specified thread and spoof the Parent Process](https://github.com/hlldz/APC-PPID)
* 白加黑技术
  * [marpie/signed-loaders - signed-loaders documents Windows executables that can be used for side-loading DLLs](https://github.com/marpie/signed-loaders)
* Unhooking
  * [NtRaiseHardError/AntiHook - PoC designed to evade userland-hooking anti-virus](https://github.com/NtRaiseHardError/AntiHook)
* UNIX / Linux
  * [SoldierX/libhijack - FreeBSD Code Injection Swiss Army Knife](https://github.com/SoldierX/libhijack)
  * [emptymonkey/sigsleeper - Inject shellcode into running processes in Linux](https://github.com/emptymonkey/sigsleeper)
  * [ixty/mandibule - linux elf injector for x86 x86_64 arm arm64 - 通过 /proc/PID/auxv 定位 argv 地址，然后实现ELF参数控制；其他原理类似 libreflect](https://github.com/ixty/mandibule)
  * [rapid7/mettle/libreflect - ELF内存加载，支持低版本内核，但是不支持UPX程序](https://github.com/rapid7/mettle/tree/master/libreflect)
  * [DavidBuchanan314/dlinject - Inject a shared library (i.e. arbitrary code) into a live linux process, without ptrace - Python实现，需要重写](https://github.com/DavidBuchanan314/dlinject)
* Windows .NET
  * [unknownv2/CoreHook - A library that simplifies intercepting application function calls using managed code and the .NET Core runtime](https://github.com/unknownv2/CoreHook)
* Windows C++
  * [monoxgas/Koppeling - Adaptive DLL hijacking / dynamic export forwarding](https://github.com/monoxgas/Koppeling)
  * [anhkgg/SuperDllHijack - 一种通用Dll劫持技术，不再需要手工导出Dll的函数接口了](https://github.com/anhkgg/SuperDllHijack)
  * [fdiskyou/injectAllTheThings - Seven different DLL injection techniques in one single project](https://github.com/fdiskyou/injectAllTheThings)
  * [stephenfewer/ReflectiveDLLInjection - a library injection technique in which the concept of reflective programming is employed to perform the loading of a library from memory into a host process](https://github.com/stephenfewer/ReflectiveDLLInjection)
  * [SafeBreach-Labs/pinjectra - Pinjectra is a C/C++ OOP-like library that implements Process Injection techniques (with focus on Windows 10 64-bit)](https://github.com/SafeBreach-Labs/pinjectra)
  * [dadas190/Heavens-Gate-2.0 - Executes 64bit code from a 32bit process](https://github.com/dadas190/Heavens-Gate-2.0)
  * [djhohnstein/ProcessReimaging - Process reimaging proof of concept code](https://github.com/djhohnstein/ProcessReimaging)
    * [You Can Run, But You Can’t Hide — Detecting Process Reimaging Behavior](https://posts.specterops.io/you-can-run-but-you-cant-hide-detecting-process-reimaging-behavior-e6bb9a10c40b)
  * [NtRaiseHardError/Dreadnought - PoC for detecting and dumping code injection (built and extended on UnRunPE)](https://github.com/NtRaiseHardError/Dreadnought)
  * [antonioCoco/Mapping-Injection - Just another Windows Process Injection](https://github.com/antonioCoco/Mapping-Injection)
  * [rootm0s/Injectors - DLL/Shellcode injection techniques](https://github.com/rootm0s/Injectors)
  * [theevilbit/injection - Injection techniques](https://github.com/theevilbit/injection)
  * [odzhan/injection - Windows process injection methods (modexp 新研究的各种注入方式)](https://github.com/odzhan/injection)
  * [wbenny/injdrv - proof-of-concept Windows Driver for injecting DLL into user-mode processes using APC](https://github.com/wbenny/injdrv)
  * [vallejocc/PoC-Inject-Data-WM_COPYDATA - A tiny PoC to inject and execute code into explorer.exe with WM_SETTEXT+WM_COPYDATA+SetThreadContext](https://github.com/vallejocc/PoC-Inject-Data-WM_COPYDATA)
  * [countercept/doublepulsar-usermode-injector - A utility to use the usermode shellcode from the DOUBLEPULSAR payload to reflectively load an arbitrary DLL into another process](https://github.com/countercept/doublepulsar-usermode-injector)
  * [DarthTon/Xenos - Windows dll injector](https://github.com/DarthTon/Xenos)
  * [Akaion/Bleak - A Windows native DLL injection library written in C# that supports several methods of injection](https://github.com/Akaion/Bleak)
  * [BorjaMerino/Pazuzu - Reflective DLL to run binaries from memory](https://github.com/BorjaMerino/Pazuzu)
  * [vmcall/loadlibrayy - x64 manualmapper with kernel elevation and thread hijacking capabilities](https://github.com/vmcall/loadlibrayy)
  * [hlldz/APC-PPID - Adds a user-mode asynchronous procedure call (APC) object to the APC queue of the specified thread and spoof the Parent Process](https://github.com/hlldz/APC-PPID)
  * [zeroKilo/ProxyDllMaker - Tool to generate proxy dll templates](https://github.com/zeroKilo/ProxyDllMaker)
  * [hasherezade/module_overloading - A more stealthy variant of "DLL hollowing"](https://github.com/hasherezade/module_overloading)
  * [dismantl/ImprovedReflectiveDLLInjection - An improvement of the original reflective DLL injection technique by Stephen Fewer - 2016停更](https://github.com/dismantl/ImprovedReflectiveDLLInjection)
  * [forrest-orr/phantom-dll-hollower-poc - Phantom DLL hollowing PoC](https://github.com/forrest-orr/phantom-dll-hollower-poc)
* Windows driver
  * [wbenny/injdrv - proof-of-concept Windows Driver for injecting DLL into user-mode processes using APC](https://github.com/wbenny/injdrv)
  * [haidragon/KeInject - win7 apc注入不支持win10](https://github.com/haidragon/KeInject)
  * [adrianyy/KeInject - Kernel LdrLoadDll injector](https://github.com/adrianyy/KeInject)
* Windows dotnet
  * [pwndizzle/c-sharp-memory-injection - A set of scripts that demonstrate how to perform memory injection in C#](https://github.com/pwndizzle/c-sharp-memory-injection)
  * [jonatan1024/clrinject - Injects C# EXE or DLL Assembly into every CLR runtime and AppDomain of another process](https://github.com/jonatan1024/clrinject)
  * [CameronAavik/ILject - Provides a way which you can load a .NET dll/exe from disk, modify/inject IL, and then run the assembly all in memory without modifying the file](https://github.com/CameronAavik/ILject)
  * [djhohnstein/.NET-Profiler-DLL-Hijack - Implementation of the .NET Profiler DLL hijack in C#](https://github.com/djhohnstein/.NET-Profiler-DLL-Hijack)
  * [marcin-chwedczuk/dll-inject - Simple DLL injector written in C#](https://github.com/marcin-chwedczuk/dll-inject)
  * [ambray/ProcessHollowing - Simple Process Hollowing in C#](https://github.com/ambray/ProcessHollowing)
* MacOS
  * [tihmstar/libtakeover - call functions in a remote process using Mach API](https://github.com/tihmstar/libtakeover)
  * [userlandkernel/mach-hook - Hooking mach-o libraries in current or remote processes by patching GOT and NLIST](https://github.com/userlandkernel/mach-hook)

Application hooks

* [tandasat/DdiMon - a hypervisor performing inline hooking that is invisible to a guest (ie, any code other than DdiMon) by using extended page table (EPT)](https://github.com/tandasat/DdiMon)
* [tinysec/iathook - windows kernelmode and usermode IAT hook](https://github.com/tinysec/iathook)
* [gdabah/distormx - The ultimate hooking library](https://github.com/gdabah/distormx)
* [stevemk14ebr/PolyHook - x86/x64 C++ Hooking Library](https://github.com/stevemk14ebr/PolyHook)
* [tandasat/DotNetHooking - Sample use cases of the .NET native code hooking technique](https://github.com/tandasat/DotNetHooking)
* [secrary/Hooking-via-InstrumentationCallback](https://github.com/secrary/Hooking-via-InstrumentationCallback)
* [EasyHook - The reinvention of Windows API Hooking ](https://github.com/EasyHook/EasyHook)
* [int0/ProcessIsolator - Utility to hook SSDT of specific process and transfer control to a service (usermode app) for handling to determine action allow/deny API call etc](https://github.com/int0/ProcessIsolator)
* [Sentinel-One/minhook - The Minimalistic x86/x64 API Hooking Library for Windows](https://github.com/Sentinel-One/minhook)
* [everdox/InfinityHook - Hook system calls, context switches, page faults and more](https://github.com/everdox/InfinityHook)
* [citronneur/detours.net - Hook native API with C#](https://github.com/citronneur/detours.net)
* [wbenny/DetoursNT - Detours with just single dependency - NTDLL](https://github.com/wbenny/DetoursNT)
* Kernel 
  * [ilammy/ftrace-hook - Using ftrace for function hooking in Linux kernel](https://github.com/ilammy/ftrace-hook)

Examples

* [LloydLabs/Windows-API-Hashing - This is a simple example and explanation of obfuscating API resolution via hashing](https://github.com/LloydLabs/Windows-API-Hashing)
* [arcadejust/MultiotpCPV2RDP - Credential Provider V2 for Win8 and Win10 with RDP only option](https://github.com/arcadejust/MultiotpCPV2RDP)

Uncategorized

* [wbenny/pdbex - a utility for reconstructing structures and unions from the PDB into compilable C headers](https://github.com/wbenny/pdbex)
* [86hh/POC-viruses - POC viruses I have created to demo some ideas - 说是跟CFG有关](https://github.com/86hh/POC-viruses)
* [processhacker/phnt - Native API header files for the Process Hacker project](https://github.com/processhacker/phnt)
* [93aef0ce4dd141ece6f5/Packer - PoC executable packer using resources](https://github.com/93aef0ce4dd141ece6f5/Packer)
* [silentsignal/sheep-wolf - evilize - create pairs of executable files with the same MD5 hash - 同时修改两个文件，让他们的MD5相同](https://github.com/silentsignal/sheep-wolf/tree/master/evilize)
* [vithakur/schneiken - This repo has the decoded Schneiken dropper files](https://github.com/vithakur/schneiken)
* [gist: hyperdetect.c](https://gist.github.com/drew-gpf/d31840bebbbb1ff1d112a6f46e162c05)

### References

Documents

* [0x00sec.org: Userland API Monitoring and Code Injection Detection](https://0x00sec.org/t/userland-api-monitoring-and-code-injection-detection/5565)
* [exatrack.com: Sysmon Internals - 主要介绍驱动级的监控实现](https://exatrack.com/public/SysmonInternals.pdf)
* [2018.romhack.io: show me your privileges and I will lead you to SYSTEM - SeDebug注入任意程序提权，SeBackup/SeRestore读写任意文件注册表，SeTakeOvership修改任意权限，SeTcb/SeCreateToken任意权限切换；需要清理EventLog](https://2018.romhack.io/slides/RomHack%202018%20-%20Andrea%20Pierini%20-%20whoami%20priv%20-%20show%20me%20your%20Windows%20privileges%20and%20I%20will%20lead%20you%20to%20SYSTEM.pdf)
  * [Creating Windows Access Tokens - SeTcbPrivilege 权限可以创建 token，未测试](https://decoder.cloud/2019/07/04/creating-windows-access-tokens/)

Case study

* [KoiMiner挖矿木马变种入侵 超5000台SQL Server服务器被控制](https://s.tencent.com/research/report/567.html)
* [腾讯安全: 2018年高级持续性威胁（APT）研究报告](https://www.freebuf.com/articles/network/193420.html)
* [360: APT 海莲花](https://ti.qianxin.com/uploads/2019/05/08/e159233f9b2b714ba1e76e3e1b84deba.pdf)
* [Formbook - In-depth malware analysis (Botconf 2018)](https://www.slideshare.net/RmiJullian/formbook-indepth-malware-analysis-botconf-2018/)

### Source codes

Bootkit

* [Darkabode/zerokit - Zerokit/GAPZ rootkit (non buildable and only for researching)](https://github.com/Darkabode/zerokit)
* [Mattiwatti/EfiGuard - Disable PatchGuard and DSE at boot time](https://github.com/Mattiwatti/EfiGuard)
* [can1357/ByePg - Defeating Patchguard universally for Windows 8, Windows 8.1 and all versions of Windows 10 regardless of HVCI](https://github.com/can1357/ByePg)

Agent

* [mwsrc - Malware source code database](https://github.com/mwsrc)
* [maestron/botnets - This is a collection of #botnet source codes, unorganized](https://github.com/maestron/botnets)
* [hzeroo/Carberp - 比krab.rar少一些内容](https://github.com/hzeroo/Carberp)
* [ytisf/theZoo - A repository of LIVE malwares for your own joy and pleasure](https://github.com/ytisf/theZoo)
* [Aekras1a/Updated-Carbanak-Source-with-Plugins](https://github.com/Aekras1a/Updated-Carbanak-Source-with-Plugins)
* [rossja/TinyNuke - the source code of TinyNuke which is a zeus-style trojan](https://github.com/rossja/TinyNuke)
* [nyx0/Dendroid - Android 2015年的](https://github.com/nyx0/Dendroid)
* [mushinnomushin/ZeuS_2.0.8.9 - 2013年的](https://github.com/mushinnomushin/ZeuS_2.0.8.9)
* [LiveMirror/pcshare - PCSHARE 老版本源代码](https://github.com/LiveMirror/pcshare)
  * [xdnice/PCShare - 不知道这个是什么版本的，代码是否一样](https://github.com/xdnice/PCShare)

Rootkit

* [hfiref0x/ZeroAccess - ZeroAccess v3 toolkit - P2P + 内核rootkit](https://github.com/hfiref0x/ZeroAccess)
* [repnz/autochk-rootkit - Reverse engineered source code of the autochk rootkit - 隐藏文件、网络连接等等](https://github.com/repnz/autochk-rootkit)

Panel

* [runvirus/LokiPWS - Loki PWS - Control Panel New Version leaked](https://github.com/runvirus/LokiPWS)
* [prsecurity/Neutrino - Neutrino C2 Source Code](https://github.com/prsecurity/Neutrino)
* [0xffff0800/muddyc3 - Leaked Muddyc3 C2 source](https://github.com/0xffff0800/muddyc3)

Uncategorized

* [s3cj0y/maybe-carbanak-group_ib_smart_boys - carbanak\\group_ib_smart_boys All from Internet](https://github.com/s3cj0y/maybe-carbanak-group_ib_smart_boys)
* [hackedteam 2015年泄露的源代码](https://github.com/hackedteam?tab=repositories)
* [Te-k/flexidie - Source code and binaries of FlexiSpy from the Flexidie dump](https://github.com/Te-k/flexidie)
* [x0rz/EQGRP_Lost_in_Translation - Decrypted content of odd.tar.xz.gpg, swift.tar.xz.gpg and windows.tar.xz.gpg](https://github.com/x0rz/EQGRP_Lost_in_Translation)
  * [nneonneo/eqgrp-free-file - Free sampling of files from the purported Equation Group hack](https://github.com/nneonneo/eqgrp-free-file)
* [guitmz/virii - Collection of ancient computer virus source codes](https://github.com/guitmz/virii)
* [blackorbird/APT_REPORT/APT34 - 仓库里的 apt34leak-part2.zip 是泄露的源代码](https://github.com/blackorbird/APT_REPORT/tree/master/APT34)
* [cellebrited/cellebrite - 不知道什么代码](https://github.com/cellebrited/cellebrite)



